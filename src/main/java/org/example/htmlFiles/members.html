<!DOCTYPE html>
<html>
<head>
    <title>Members</title>
</head>
<body>
<h1>Members</h1>

<table>
    <thead>
    <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Email</th>
    </tr>
    </thead>
    <tbody id="member-list">
    </tbody>
</table>

<h2>Add New Member</h2>
<form id="add-member-form">
    <label for="name">Name:</label>
    <input type="text" id="name" name="name" required><br><br>

    <label for="email">Email:</label>
    <input type="email" id="email" name="email" required><br><br>

    <button type="submit">Add Member</button>
</form>

<script>
    // Fetch member data and populate the table
    function loadMembers() {
        fetch('/members')
            .then(response => response.json())
            .then(members => {
                const memberList = document.getElementById('member-list');
                memberList.innerHTML = ''; // Clear existing data
                members.forEach(member => {
                    const row = memberList.insertRow();
                    row.insertCell().textContent = member.id;
                    row.insertCell().textContent = member.name;
                    row.insertCell().textContent = member.email;
                });
            });
    }

    // Handle form submission
    document.getElementById('add-member-form').addEventListener('submit', function(event) {
        event.preventDefault(); // Prevent default form submission

        const form = event.target;
        fetch(form.action, {
            method: form.method,
            body: new URLSearchParams(new FormData(form)) // Encode form data
        })
            .then(response => {
                if (response.ok) {
                    loadMembers(); // Reload member data
                    form.reset(); // Clear the form
                } else {
                    alert('Error adding member: ' + response.status);
                }
            });
    });

    // Initial load
    loadMembers();
</script>
</body>
</html>